<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Observability to Java Applications with OpenTelemetry Java Agent</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body {
            font-family: sans-serif;
            background-color: #f8fafc;
            color: #1f2937;
            margin: 0;
            padding: 0;
        }
    </style>
    
</head>
<body>
<div id="toc" class="toc">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#build-a-tiny-agent-carrier-image">Build a tiny "agent carrier" image</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="build-a-tiny-agent-carrier-image">Build a tiny "agent carrier" image</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">java-otel-agent/Dockerfile</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="dockerfile"><span class="c"># --- Stage 1: fetch agent ---</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">alpine:3.20</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">fetcher</span>
<span class="c">#ARG OTEL_JAVA_AGENT_VERSION=2.7.0</span>
<span class="k">ARG</span><span class="s"> OTEL_JAVA_AGENT_VERSION=2.20.1</span>
<span class="k">RUN </span>apk add <span class="nt">--no-cache</span> curl <span class="se">\
</span> <span class="o">&amp;&amp;</span> curl <span class="nt">-L</span> <span class="nt">-o</span> /tmp/opentelemetry-javaagent.jar <span class="se">\
</span>    https://github.com/open-telemetry/opentelemetry-java-instrumentation/releases/download/v<span class="k">${</span><span class="nv">OTEL_JAVA_AGENT_VERSION</span><span class="k">}</span>/opentelemetry-javaagent.jar

<span class="c"># --- Stage 2: minimal runtime with sh/cp (busybox) ---</span>
<span class="k">FROM</span><span class="s"> busybox:1.36</span>
<span class="k">USER</span><span class="s"> 65532:65532        # nonroot</span>
<span class="k">WORKDIR</span><span class="s"> /opt/otel</span>
<span class="k">COPY</span><span class="s"> --from=fetcher /tmp/opentelemetry-javaagent.jar /opt/otel/opentelemetry-javaagent.jar</span>

<span class="c"># Place your own extensions to /opt/otel/ directory.</span>
<span class="c">#COPY nsa2-otel-extension-1.0-all.jar /opt/otel/</span>

<span class="c"># optional default entrypoint; weâ€™ll override in the initContainer anyway</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["sh","-c","cp -f /opt/otel/opentelemetry-javaagent.jar \"$OTEL_AGENT_OUT_DIR/$OTEL_AGENT_FILENAME\""]</span></code></pre>
</div>
</div>
</div>
</div>
</body>
</html>