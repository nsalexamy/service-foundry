<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Installing Feast on Kubernetes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body {
            font-family: sans-serif;
            background-color: #f8fafc;
            color: #1f2937;
            margin: 0;
            padding: 0;
        }
    </style>
    
</head>
<body>
<div id="toc" class="toc">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#investigate-helm-charts">Investigate Helm Charts</a>
<ul class="sectlevel2">
<li><a href="#feast-helm-charts">Feast Helm Charts</a></li>
<li><a href="#common">Common</a></li>
<li><a href="#feast">Feast</a></li>
<li><a href="#feast-feature-server">Feast Feature Server</a></li>
</ul>
</li>
<li><a href="#installation">Installation</a>
<ul class="sectlevel2">
<li><a href="#install-feast-feature-server">Install Feast Feature Server</a></li>
<li><a href="#deploy-feast-secret">Deploy feast-secret</a></li>
<li><a href="#create-feast-database">Create feast database</a></li>
</ul>
</li>
<li><a href="#custom-values-yaml">custom-values.yaml</a></li>
<li><a href="#install-feast-feature-server-2">Install Feast Feature Server</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A Kubernetes cluster</p>
</li>
<li>
<p>Helm 3 installed</p>
</li>
<li>
<p>Feast CLI installed</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="investigate-helm-charts">Investigate Helm Charts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="feast-helm-charts">Feast Helm Charts</h3>
<div class="paragraph">
<p>There are two helm charts for Feast:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>feast: <a href="https://github.com/feast-dev/feast/tree/master/infra/charts/feast" class="bare">https://github.com/feast-dev/feast/tree/master/infra/charts/feast</a></p>
</li>
<li>
<p>feast-feature-server: <a href="https://github.com/feast-dev/feast/tree/master/infra/charts/feast-feature-server" class="bare">https://github.com/feast-dev/feast/tree/master/infra/charts/feast-feature-server</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Choose the right chart for your needs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>feast: <a href="https://github.com/feast-dev/feast/tree/master/infra/charts/feast" class="bare">https://github.com/feast-dev/feast/tree/master/infra/charts/feast</a></p>
</li>
<li>
<p>feast-feature-server: <a href="https://github.com/feast-dev/feast/tree/master/infra/charts/feast-feature-server" class="bare">https://github.com/feast-dev/feast/tree/master/infra/charts/feast-feature-server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="common">Common</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ REPO_URL</span><span class="o">=</span>https://feast-helm-charts.storage.googleapis.com
<span class="nv">$ NAMESPACE</span><span class="o">=</span>mlops</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="feast">Feast</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c">#$ mkdir -p helm-charts/feast</span>
<span class="c">#$ cd helm-charts/feast</span>

<span class="nv">$ CHART_NAME</span><span class="o">=</span>feast

<span class="nv">$ CHART_VERSION</span><span class="o">=</span><span class="si">$(</span>helm show chart <span class="nv">$CHART_NAME</span> <span class="nt">--repo</span> <span class="nv">$REPO_URL</span> | yq .version<span class="si">)</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="save-chart">Save Chart</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>helm pull <span class="nv">$CHART_NAME</span> <span class="nt">--repo</span> <span class="nv">$REPO_URL</span> <span class="nt">--version</span> <span class="nv">$CHART_VERSION</span> <span class="nt">--untar</span> <span class="nt">--untardir</span> chart</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="feast-feature-server">Feast Feature Server</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c">#$ mkdir -p helm-charts/feast-feature-server</span>
<span class="c">#$ cd helm-charts/feast-feature-server</span>

<span class="nv">$ CHART_NAME</span><span class="o">=</span>feast-feature-server

<span class="nv">$ CHART_VERSION</span><span class="o">=</span><span class="si">$(</span>helm show chart <span class="nv">$CHART_NAME</span> <span class="nt">--repo</span> <span class="nv">$REPO_URL</span> | yq .version<span class="si">)</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="save-chart-2">Save Chart</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>helm pull <span class="nv">$CHART_NAME</span> <span class="nt">--repo</span> <span class="nv">$REPO_URL</span> <span class="nt">--version</span> <span class="nv">$CHART_VERSION</span> <span class="nt">--untar</span> <span class="nt">--untardir</span> chart</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation">Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="install-feast-feature-server">Install Feast Feature Server</h3>
<div class="listingblock">
<div class="title">feature_store.yaml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">project: mlops

registry:
  registry_type: sql
  path: postgresql+psycopg://<span class="k">${</span><span class="nv">POSTGRESQL_USERNAME</span><span class="k">}</span>:<span class="k">${</span><span class="nv">POSTGRESQL_PASSWORD</span><span class="k">}</span>@<span class="k">${</span><span class="nv">POSTGRESQL_HOST</span><span class="k">}</span>:<span class="k">${</span><span class="nv">POSTGRESQL_PORT</span><span class="k">}</span>/<span class="k">${</span><span class="nv">POSTGRESQL_DATABASE</span><span class="k">}</span>

online_store:
  <span class="nb">type</span>: redis
  connection_string: <span class="s2">"redis://:</span><span class="k">${</span><span class="nv">REDIS_PASSWORD</span><span class="k">}</span><span class="s2">@</span><span class="k">${</span><span class="nv">REDIS_HOST</span><span class="k">}</span><span class="s2">:</span><span class="k">${</span><span class="nv">REDIS_PORT</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">REDIS_DB</span><span class="k">}</span><span class="s2">"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Encode feature_store.yaml to base64</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cat feature_store.yaml | base64 | pbcopy</pre>
</div>
</div>
<div class="listingblock">
<div class="title">custom-values.yaml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">feature_store_yaml_base64</span><span class="pi">:</span> <span class="s2">"</span><span class="s">paste-base64-encoded-feature_store.yaml-here"</span>

<span class="na">extraEnvs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">POSTGRESQL_USERNAME"</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">admin"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">POSTGRESQL_HOST"</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgresql.service-foundry.svc.cluster.local"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">POSTGRESQL_PORT"</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">5432"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">POSTGRESQL_DATABASE"</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">feast"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">REDIS_HOST"</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">redis-master.service-foundry.svc.cluster.local"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">REDIS_PORT"</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">6379"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">REDIS_DB"</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">POSTGRESQL_PASSWORD"</span>
    <span class="na">valueFrom</span><span class="pi">:</span>
      <span class="na">secretKeyRef</span><span class="pi">:</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">feast-secret</span>
        <span class="na">key</span><span class="pi">:</span> <span class="s">POSTGRESQL_PASSWORD</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">REDIS_PASSWORD"</span>
    <span class="na">valueFrom</span><span class="pi">:</span>
      <span class="na">secretKeyRef</span><span class="pi">:</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">feast-secret</span>
        <span class="na">key</span><span class="pi">:</span> <span class="s">REDIS_PASSWORD</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploy-feast-secret">Deploy feast-secret</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ NAMESPACE</span><span class="o">=</span>mlops
<span class="nv">$ </span>kubectl get namespace <span class="nv">$NAMESPACE</span> &amp;&gt;/dev/null <span class="o">||</span> kubectl create namespace <span class="nv">$NAMESPACE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply feast-secret</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl apply <span class="nt">-f</span> feast-secret.yaml <span class="nt">-n</span> <span class="nv">$NAMESPACE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify feast-secret</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl get secret feast-secret <span class="nt">-n</span> <span class="nv">$NAMESPACE</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-feast-database">Create feast database</h3>
<div class="paragraph">
<p>database name: feast</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom-values-yaml">custom-values.yaml</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="install-feast-feature-server-2">Install Feast Feature Server</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ NAMESPACE</span><span class="o">=</span>mlops
<span class="nv">$ RELEASE_NAME</span><span class="o">=</span>feast-feature-server
<span class="nv">$ CHART_NAME</span><span class="o">=</span>feast-feature-server
<span class="nv">$ REPO_URL</span><span class="o">=</span>https://feast-helm-charts.storage.googleapis.com
<span class="nv">$ CHART_VERSION</span><span class="o">=</span><span class="si">$(</span>helm show chart <span class="nv">$CHART_NAME</span> <span class="nt">--repo</span> <span class="nv">$REPO_URL</span> | yq .version<span class="si">)</span>

<span class="nv">$ </span>helm upgrade <span class="nt">--install</span> <span class="nv">$RELEASE_NAME</span> <span class="se">\</span>
  <span class="nt">--repo</span> <span class="nv">$REPO_URL</span>  <span class="nv">$CHART_NAME</span> <span class="se">\</span>
  <span class="nt">--namespace</span> <span class="nv">$NAMESPACE</span> <span class="se">\</span>
  <span class="nt">--create-namespace</span> <span class="se">\</span>
  <span class="nt">--version</span> <span class="nv">$CHART_VERSION</span> <span class="se">\</span>
  <span class="nt">--values</span> custom-values.yaml

<span class="nv">$ </span>helm upgrade <span class="nt">--install</span> feast-feature-server <span class="se">\</span>
  <span class="nt">--repo</span> https://feast-helm-charts.storage.googleapis.com <span class="se">\</span>
  feast-feature-server <span class="se">\</span>
  <span class="nt">--namespace</span> mlops <span class="se">\</span>
  <span class="nt">--create-namespace</span> <span class="se">\</span>
  <span class="nt">--version</span> 0.60.0 <span class="se">\</span>
  <span class="nt">--values</span> custom-values.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify Feast Feature Server</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl get all <span class="nt">-n</span> mlops</code></pre>
</div>
</div>
</div>
</div>
</body>
</html>