<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Streamlining Kubernetes GitOps with the Service Foundry Console</title>
    <!-- rouge source highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/service-foundry/pages/assets/css/main.css">

    <!-- Highlight.js script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</head>
<body class="">

<!-- Header -->
<header>
<!--    <div class="logo text-xl font-semibold">Service Foundry</div>-->
    <a href="/service-foundry/pages/index.html" class="text-2xl font-semibold hover:text-teal-400">
    Service Foundry
</a>
    <nav>
    
        
        <a href="/service-foundry/pages/getting-started/" class="">Getting Started</a>
    
        
        <a href="/service-foundry/pages/products/" class="">Products</a>
    
        
        <a href="/service-foundry/pages/documents/" class="active">Docs</a>
    
        
        <a href="/service-foundry/pages/github/" class="">GitHub</a>
    
        
        <a href="/service-foundry/pages/developers/" class="">Developers</a>
    
        
        <a href="/service-foundry/pages/demo/" class="">Demo</a>
    
</nav>
</header>


    <!-- Sub-navigation for Foundries -->
    <div class="subnav">

    
    <a href="/service-foundry/pages/documents/blog/" class="active">Blog</a>

    
    <a href="/service-foundry/pages/documents/infra-foundry/" class="">Infra</a>

    
    <a href="/service-foundry/pages/documents/sso-foundry/" class="">SSO</a>

    
    <a href="/service-foundry/pages/documents/o11y-foundry/" class="">Observability</a>

    
    <a href="/service-foundry/pages/documents/backend-foundry/" class="">Backend</a>

    
    <a href="/service-foundry/pages/documents/bigdata-foundry/" class="">Big Data</a>

<!--    <a href="/service-foundry/pages/documents/infra-foundry/index-backup.html" class="text-gray-300 hover:text-white">Infra</a>-->
<!--    <a href="/service-foundry/pages/documents/sso-foundry/index-backup.html" class="text-gray-300 hover:text-white">SSO</a>-->
<!--    <a href="/service-foundry/pages/documents/o11y-foundry/index-backup.html" class="text-gray-300 hover:text-white">Observability</a>-->
<!--    <a href="/service-foundry/pages/documents/backend-foundry/index-backup.html" class="text-gray-300 hover:text-white">Backend</a>-->
<!--    <a href="/service-foundry/pages/documents/bigdata-foundry/index-backup.html" class="text-gray-300 hover:text-white">Big Data</a>-->
</div>





<!-- Breadcrumb -->

    <nav class="breadcrumb-wrapper">
    <ol class="breadcrumb">
        
        <li>
            
            <a href="/service-foundry/pages/">Home</a>
            
            
            <span class="separator">/</span>
            
        </li>
        
        <li>
            
            <a href="/service-foundry/pages/documents/">Docs</a>
            
            
            <span class="separator">/</span>
            
        </li>
        
        <li>
            
            <a href="/service-foundry/pages/documents/blog/">Blog</a>
            
            
        </li>
        
    </ol>
</nav>





<!-- Main Layout -->
<div class="container">


    <nav id="toc-container" class="toc-nav"></nav>


    <main id="main-content">
        
        <div class="author-box">
            Young Gyu Kim
            &lt;<a href="mailto:credemol@gmail.com" style="color: #0d9488; text-decoration: none;">credemol@gmail.com</a>&gt;
        </div>
        

        <!-- Title -->
        
        <h1 class="page-title">
            Streamlining Kubernetes GitOps with the Service Foundry Console
        </h1>
        

        <div class="asciidoc">
            <div id="toc" class="toc">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#architecture-overview">Architecture Overview</a></li>
<li><a href="#bootstrapping-gitops-with-service-foundry-builder">Bootstrapping GitOps with Service Foundry Builder</a>
<ul class="sectlevel2">
<li><a href="#key-bootstrap-tasks">Key Bootstrap Tasks</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#environment-variables">Environment Variables</a></li>
</ul>
</li>
<li><a href="#avoid-storing-aws-credentials-in-secrets">Avoid storing AWS credentials in Secrets</a>
<ul class="sectlevel2">
<li><a href="#updating-aws-auth-configmap-in-kube-system-namespace">Updating aws-auth ConfigMap in kube-system Namespace</a></li>
</ul>
</li>
<li><a href="#bootstrap-command">Bootstrap Command</a></li>
<li><a href="#installed-components">Installed Components</a>
<ul class="sectlevel2">
<li><a href="#kubernetes-manifest-files-in-git">Kubernetes manifest files in Git</a></li>
<li><a href="#argocd">ArgoCD</a></li>
<li><a href="#sealed-secrets">Sealed Secrets</a></li>
<li><a href="#keycloak">Keycloak</a></li>
<li><a href="#traefik">Traefik</a></li>
<li><a href="#service-foundry-console-frontend">Service Foundry Console (Frontend)</a></li>
<li><a href="#service-foundry-console-backend">Service Foundry Console (Backend)</a></li>
<li><a href="#oauth2-proxy">Oauth2 Proxy</a></li>
<li><a href="#sso-integration">SSO Integration</a></li>
</ul>
</li>
<li><a href="#accessing-service-foundry-console">Accessing Service Foundry Console</a>
<ul class="sectlevel2">
<li><a href="#dns-configuration">DNS Configuration</a></li>
<li><a href="#logging-in">Logging In</a></li>
<li><a href="#application-management-ui">Application Management UI</a></li>
</ul>
</li>
<li><a href="#auto-sync-with-argocd">Auto Sync with ArgoCD</a></li>
<li><a href="#future-enhancements">Future Enhancements</a>
<ul class="sectlevel2">
<li><a href="#kubernetes-resource-management">Kubernetes Resource Management</a></li>
<li><a href="#integrated-monitoring-and-observability">Integrated Monitoring and Observability</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="imageblock img-wide">
<div class="content">
<img src="images/streamline-k8s-gitops.png" alt="streamline k8s gitops">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Service Foundry Console is a web-based interface designed to simplify the management of Kubernetes resources and GitOps workflows. It offers an intuitive and unified experience for deploying, monitoring, and managing applications in cloud-native environments.</p>
</div>
<div class="paragraph">
<p>As the dedicated frontend for the Service Foundry Builder platform, the Console integrates seamlessly with modules for infrastructure provisioning, observability, single sign-on (SSO), and more. This integration enables development and operations teams to collaborate more effectively through a visual and configuration-driven interface.</p>
</div>
<div class="paragraph">
<p>Built on a React frontend and a Go-based backend, the Console interacts directly with Kubernetes clusters and Git repositories—making GitOps adoption smooth, reliable, and scalable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture-overview">Architecture Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Service Foundry Console architecture is designed for a seamless GitOps and Kubernetes resource management experience. It is composed of the following core components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Frontend</strong>: A modern web interface built with React.js, providing users with intuitive controls for provisioning, deploying, and visualizing Kubernetes resources. It also displays the live state of applications synced through GitOps.</p>
</li>
<li>
<p><strong>Backend</strong>: A Go-based REST API that serves as the bridge between the frontend, Kubernetes cluster, and Git repositories. It processes user actions, handles deployment logic, and manages configuration state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Together, these components deliver a smooth and responsive platform for managing complex Kubernetes workflows across environments.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrapping-gitops-with-service-foundry-builder">Bootstrapping GitOps with Service Foundry Builder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <strong>bootstrap command</strong> provided by Service Foundry Builder sets up the foundation for your GitOps workflow. It automates the installation and configuration of all necessary components to manage Kubernetes infrastructure and application delivery using GitOps principles.</p>
</div>
<div class="sect2">
<h3 id="key-bootstrap-tasks">Key Bootstrap Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>Installs <strong>Argo CD</strong> and configures it for managing Kubernetes applications.</p>
</li>
<li>
<p>Installs <strong>Sealed Secrets</strong> to securely store and manage sensitive data.</p>
</li>
<li>
<p>Installs <strong>Keycloak</strong> for centralized identity and access management (SSO).</p>
</li>
<li>
<p>Installs <strong>Traefik</strong> for ingress routing and traffic control.</p>
</li>
<li>
<p>Deploys the Service Foundry Console (Frontend) and its Backend APIs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These steps eliminate manual setup and ensure that all services are integrated out of the box for a smooth GitOps experience.</p>
</div>
</div>
<div class="sect2">
<h3 id="prerequisites">Prerequisites</h3>
<div class="paragraph">
<p>To bootstrap the environment, you will need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A Git repository</strong> (preferably empty) to store configuration and manifest files. The bootstrap process will automatically create a folder structure (e.g., $ARGOCD_APP_PREFIX_apps) and push the necessary YAML files.</p>
</li>
<li>
<p><strong>A Kubernetes cluster</strong> where Service Foundry will be installed. AWS EKS is supported today, with AKS and GKE support planned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Git Repository Setup</p>
</div>
<div class="paragraph">
<p>We recommend creating a dedicated Git repository for Service Foundry Builder. A Deploy Key with write access must be configured to allow the builder to push manifests and updates.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/github-empty-repo.png" alt="github empty repo">
</div>
<div class="title">Figure 1. GitHub Repository for Service Foundry Builder (empty)</div>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/github-deploy-key.png" alt="github deploy key">
</div>
<div class="title">Figure 2. GitHub Deploy Key for Service Foundry Builder</div>
</div>
</div>
<div class="sect2">
<h3 id="environment-variables">Environment Variables</h3>
<div class="paragraph">
<p>Before running the bootstrap command, you must set several environment variables that define GitOps behavior, domain routing, Kubernetes context, and component versions.</p>
</div>
<div class="sect3">
<h4 id="core-configuration">Core Configuration:</h4>
<div class="ulist">
<ul>
<li>
<p><strong>GIT_OPS_REPO_URL</strong>: Git repository URL for storing Kubernetes manifests.</p>
</li>
<li>
<p><strong>GIT_OPS_REPO_NAME</strong>: Name of the Git repository (used in config maps).</p>
</li>
<li>
<p><strong>GIT_OPS_REPO_BRANCH</strong>: Target branch for GitOps (usually main).</p>
</li>
<li>
<p><strong>ARGOCD_PROJECT</strong>: The Argo CD project name to manage deployed applications.</p>
</li>
<li>
<p><strong>SF_ROOT_DOMAIN</strong>: The root domain used to expose the frontend, backend, and SSO (e.g., nsa2.com).</p>
</li>
<li>
<p><strong>AWS_REGION</strong>: AWS region where your EKS cluster is located.</p>
</li>
<li>
<p><strong>EKS_CLUSTER_NAME</strong>: Name of the EKS cluster to deploy to.</p>
</li>
<li>
<p><strong>GIT_OPS_REPO_SSH_KEY_PATH</strong>: Path to the SSH private key for accessing your GitOps repository.</p>
</li>
<li>
<p><strong>GENERATOR_NSA2_SSH_KEY_PATH</strong>: SSH key used to access the private Service Foundry Generator repository.</p>
</li>
<li>
<p><strong>ARGOCD_APP_PREFIX</strong>: Prefix used for naming Argo CD Applications (default: sf-).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="component-versions">Component Versions:</h4>
<div class="ulist">
<ul>
<li>
<p>GENERATOR_NSA2_GIT_BRANCH: Branch of the generator repository (e.g., main).</p>
</li>
<li>
<p>SF_APP_FRONTEND_VERSION: Version of the Service Foundry Console frontend.</p>
</li>
<li>
<p>SF_APP_BACKEND_VERSION: Version of the backend API server.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="avoid-storing-aws-credentials-in-secrets">Avoid storing AWS credentials in Secrets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To securely grant your Kubernetes applications access to AWS resources without hardcoding credentials, use IAM Roles for Service Accounts (IRSA). This method binds a Kubernetes service account to an AWS IAM role with scoped permissions.</p>
</div>
<div class="paragraph">
<p><strong>Resources</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://nsalexamy.github.io/service-foundry/pages/documents/blog/kube-config-without-aws-secret-access-key/">Using IRSA without storing secrets</a></p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html">AWS Official IRSA Docs</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="updating-aws-auth-configmap-in-kube-system-namespace">Updating aws-auth ConfigMap in kube-system Namespace</h3>
<div class="paragraph">
<p>To enable the Service Foundry Builder to interact with AWS via IRSA, you must update the aws-auth ConfigMap in the kube-system namespace to associate the IAM role with the appropriate service account.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="c1"># This is supposed to be in kube-system namespace.</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">mapRoles</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">- rolearn: arn:aws:iam::YOUR_AWS_ACCOUNT_ID:role/eksctl-your-cluster-name-addon-iamserviceaccount-kubeconfig-generator-sa</span>
      <span class="s">username: system:node:{{EC2PrivateDNSName}} # This is typically for worker nodes, but conceptually similar for IRSA roles</span>
      <span class="s">groups:</span>
        <span class="s">- system:bootstrappers</span>
        <span class="s">- system:nodes</span>
    <span class="s">#</span><i class="conum" data-value="1"></i><b>(1)</b>
    <span class="s">- rolearn: arn:aws:iam::YOUR_AWS_ACCOUNT_ID:role/service-foundry-builder-role  # IRSA role for Service Foundry Builder. Created by the bootstrap command.</span>
      <span class="s">username: arn:aws:eks:YOUR_AWS_REGION:YOUR_AWS_ACCOUNT_ID:cluster/YOUR_EKS_NAME # Kubernetes user name in ~/.kube/config file.</span>
      <span class="s">groups:</span>
        <span class="s">- system:masters</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">aws-auth</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">kube-system</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Replace placeholders with your actual AWS account ID, region, and cluster name.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrap-command">Bootstrap Command</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To install the Service Foundry Builder and all its components, simply run the bootstrap script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>./bootstrap-service-foundry-builder.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>This script automates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating necessary Kubernetes namespaces</p>
</li>
<li>
<p>Configuring secrets and config maps</p>
</li>
<li>
<p>Setting up IRSA roles for AWS access</p>
</li>
<li>
<p>Deploying the Service Foundry Builder Helm chart</p>
</li>
<li>
<p>Initializing Argo CD, Keycloak, Traefik, Sealed Secrets, and the Service Foundry Console</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Script Breakdown:
 * Installs aws-secret, aws-configmap, and required GitHub deploy keys as Kubernetes secrets.
 * Configures the Service Foundry Console versions and GitOps settings.
 * Deploys the service-foundry-builder Helm chart using helm install.</p>
</div>
<div class="paragraph">
<p>A successful installation message is printed upon completion.</p>
</div>
<details>
<summary class="title">View bootstrap-service-foundry-builder.sh and irsa.sh</summary>
<div class="content">
<div class="listingblock">
<div class="title">bootstrap-service-foundry-builder.sh</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/bin/bash</span>

<span class="nb">set</span> <span class="nt">-e</span>

<span class="nv">CWD</span><span class="o">=</span><span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span>

<span class="c"># set variables that will be saved in the secrets and configmaps</span>
<span class="nv">GENERATOR_NSA2_GIT_BRANCH</span><span class="o">=</span><span class="k">${</span><span class="nv">GENERATOR_NSA2_GIT_BRANCH</span><span class="k">:-</span><span class="s2">"release-0.7.0"</span><span class="k">}</span>
<span class="nv">CLOUD_PROVIDER</span><span class="o">=</span><span class="k">${</span><span class="nv">CLOUD_PROVIDER</span><span class="k">:-}</span>
<span class="c">#AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID:-}</span>
<span class="nv">AWS_ACCOUNT_ID</span><span class="o">=</span><span class="k">${</span><span class="nv">AWS_ACCOUNT_ID</span><span class="k">:-}</span>
<span class="c">#AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY:-}</span>
<span class="nv">AWS_REGION</span><span class="o">=</span><span class="k">${</span><span class="nv">AWS_REGION</span><span class="k">:-</span><span class="s2">"us-west-2"</span><span class="k">}</span>
<span class="nv">EKS_CLUSTER_NAME</span><span class="o">=</span><span class="k">${</span><span class="nv">EKS_CLUSTER_NAME</span><span class="k">:-</span><span class="nv">young</span><span class="p">-eks</span><span class="k">}</span>
<span class="nv">GIT_OPS_REPO_URL</span><span class="o">=</span><span class="k">${</span><span class="nv">GIT_OPS_REPO_URL</span><span class="k">:-</span><span class="s2">"git@github.com:nsalexamy/service-foundry-argocd.git"</span><span class="k">}</span>
<span class="nv">GIT_OPS_REPO_NAME</span><span class="o">=</span><span class="k">${</span><span class="nv">GIT_OPS_REPO_NAME</span><span class="k">:-</span><span class="s2">"service-foundry-argocd"</span><span class="k">}</span>
<span class="nv">ARGOCD_PROJECT</span><span class="o">=</span><span class="k">${</span><span class="nv">ARGOCD_PROJECT</span><span class="k">:-</span><span class="s2">"service-foundry"</span><span class="k">}</span>
<span class="nv">SF_ROOT_DOMAIN</span><span class="o">=</span><span class="k">${</span><span class="nv">SF_ROOT_DOMAIN</span><span class="k">:-</span><span class="s2">"nsa2.com"</span><span class="k">}</span>
<span class="nv">SF_APP_FRONTEND_VERSION</span><span class="o">=</span><span class="k">${</span><span class="nv">SF_APP_FRONTEND_VERSION</span><span class="k">:-</span><span class="s2">"0.1.0"</span><span class="k">}</span>
<span class="nv">SF_APP_BACKEND_VERSION</span><span class="o">=</span><span class="k">${</span><span class="nv">SF_APP_BACKEND_VERSION</span><span class="k">:-</span><span class="s2">"0.1.0"</span><span class="k">}</span>

<span class="c"># Set the version of the service-foundry-builder chart</span>
<span class="nv">SF_BUILDER_CHART_VERSION</span><span class="o">=</span>0.1.9

<span class="c"># SSH Key Path</span>
<span class="nv">GENERATOR_NSA2_SSH_KEY_PATH</span><span class="o">=</span><span class="k">${</span><span class="nv">GENERATOR_NSA2_SSH_KEY_PATH</span><span class="k">:-</span><span class="s2">"./ssh/id_rsa"</span><span class="k">}</span>
<span class="nv">GIT_OPS_REPO_SSH_KEY_PATH</span><span class="o">=</span><span class="k">${</span><span class="nv">GIT_OPS_REPO_SSH_KEY_PATH</span><span class="k">:-</span><span class="s2">"./argocd-ssh/argocd_id_rsa"</span><span class="k">}</span>

<span class="nb">echo</span> <span class="s2">"GENERATOR_NSA2_GIT_BRANCH: </span><span class="nv">$GENERATOR_NSA2_GIT_BRANCH</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"EKS_CLUSTER_NAME: </span><span class="nv">$EKS_CLUSTER_NAME</span><span class="s2">"</span>


kubectl get namespace service-foundry &amp;&gt; /dev/null <span class="o">||</span> kubectl create namespace service-foundry

kubectl <span class="nt">-n</span> service-foundry get secret aws-secret &amp;&gt; /dev/null <span class="o">||</span> <span class="se">\</span>
kubectl <span class="nt">-n</span> service-foundry create secret generic aws-secret <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">AWS_ACCOUNT_ID</span><span class="o">=</span><span class="nv">$AWS_ACCOUNT_ID</span> <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">AWS_REGION</span><span class="o">=</span><span class="nv">$AWS_REGION</span>

<span class="nb">source</span> ./irsa.sh

kubectl <span class="nt">-n</span> service-foundry get configmap aws-configmap &amp;&gt; /dev/null <span class="o">||</span> <span class="se">\</span>
kubectl <span class="nt">-n</span> service-foundry create configmap aws-configmap <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">EKS_CLUSTER_NAME</span><span class="o">=</span><span class="nv">$EKS_CLUSTER_NAME</span>

kubectl <span class="nt">-n</span> service-foundry get secret service-foundry-github-ssh &amp;&gt; /dev/null <span class="o">||</span> <span class="se">\</span>
kubectl <span class="nt">-n</span> service-foundry create secret generic service-foundry-github-ssh <span class="se">\</span>
  <span class="nt">--from-file</span><span class="o">=</span><span class="nv">id_rsa</span><span class="o">=</span><span class="nv">$GENERATOR_NSA2_SSH_KEY_PATH</span> <span class="se">\</span>
  <span class="nt">--from-file</span><span class="o">=</span><span class="nv">argocd_id_rsa</span><span class="o">=</span><span class="nv">$GIT_OPS_REPO_SSH_KEY_PATH</span>


<span class="c"># create an empty service-foundry-builder-secret</span>
kubectl <span class="nt">-n</span> service-foundry get secret service-foundry-builder-secret &amp;&gt; /dev/null <span class="o">||</span> <span class="se">\</span>
kubectl <span class="nt">-n</span> service-foundry create secret generic service-foundry-builder-secret

kubectl <span class="nt">-n</span> service-foundry get configmap service-foundry-builder-configmap &amp;&gt; /dev/null <span class="o">||</span> <span class="se">\</span>
kubectl <span class="nt">-n</span> service-foundry create configmap service-foundry-builder-configmap <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">GIT_OPS_REPO_URL</span><span class="o">=</span><span class="s2">"</span><span class="nv">$GIT_OPS_REPO_URL</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">GIT_OPS_REPO_NAME</span><span class="o">=</span><span class="s2">"</span><span class="nv">$GIT_OPS_REPO_NAME</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">ARGOCD_PROJECT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$ARGOCD_PROJECT</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">SF_ROOT_DOMAIN</span><span class="o">=</span><span class="s2">"</span><span class="nv">$SF_ROOT_DOMAIN</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">SF_APP_FRONTEND_VERSION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$SF_APP_FRONTEND_VERSION</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">SF_APP_BACKEND_VERSION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$SF_APP_BACKEND_VERSION</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">GENERATOR_NSA2_GIT_BRANCH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$GENERATOR_NSA2_GIT_BRANCH</span><span class="s2">"</span>


<span class="c"># if service-foundry-config-files secret exists, delete it</span>
kubectl <span class="nt">-n</span> service-foundry get secret service-foundry-config-files &amp;&gt; /dev/null <span class="o">&amp;&amp;</span> <span class="se">\</span>
  kubectl <span class="nt">-n</span> service-foundry delete secret service-foundry-config-files

<span class="c"># create an empty service-foundry-config-files secret</span>
kubectl create secret generic service-foundry-config-files <span class="se">\</span>
  <span class="nt">-n</span> service-foundry

helm <span class="nb">install </span>service-foundry-builder service-foundry/service-foundry-builder <span class="se">\</span>
  <span class="nt">--set</span> <span class="nb">command</span><span class="o">=</span>bootstrap <span class="se">\</span>
  <span class="nt">--set</span> serviceAccount.annotations.<span class="s2">"eks</span><span class="se">\.</span><span class="s2">amazonaws</span><span class="se">\.</span><span class="s2">com/role-arn"</span><span class="o">=</span>arn:aws:iam::<span class="k">${</span><span class="nv">AWS_ACCOUNT_ID</span><span class="k">}</span>:role/service-foundry-builder-role <span class="se">\</span>
  <span class="nt">-n</span> service-foundry <span class="nt">--create-namespace</span> <span class="nt">--version</span> <span class="nv">$SF_BUILDER_CHART_VERSION</span>

<span class="nb">echo</span> <span class="s2">"Service Foundry Builder installed successfully."</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">irsa.sh</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/bin/bash</span>

<span class="nb">echo</span> <span class="s2">"Creating eks-update-kubeconfig-policy if it does not exist..."</span>
aws iam get-policy <span class="nt">--policy-arn</span> arn:aws:iam::<span class="k">${</span><span class="nv">AWS_ACCOUNT_ID</span><span class="k">}</span>:policy/eks-update-kubeconfig-policy &amp;&gt; /dev/null <span class="o">||</span> <span class="se">\</span>
aws iam create-policy <span class="se">\</span>
  <span class="nt">--policy-name</span> eks-update-kubeconfig-policy <span class="se">\</span>
  <span class="nt">--policy-document</span> file://eks-update-kubeconfig-policy.json


<span class="nv">OIDC_PROVIDER</span><span class="o">=</span><span class="si">$(</span>aws eks describe-cluster <span class="nt">--name</span> <span class="nv">$EKS_CLUSTER_NAME</span> <span class="nt">--region</span> <span class="nv">$AWS_REGION</span> <span class="nt">--query</span> <span class="s2">"cluster.identity.oidc.issuer"</span> <span class="nt">--output</span> text | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s2">"s/^https:</span><span class="se">\/\/</span><span class="s2">//"</span><span class="si">)</span>

<span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">  &gt; trust-policy.json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "Federated": "arn:aws:iam::</span><span class="nv">$AWS_ACCOUNT_ID</span><span class="sh">:oidc-provider/</span><span class="nv">$OIDC_PROVIDER</span><span class="sh">"
      },
      "Action": "sts:AssumeRoleWithWebIdentity",
      "Condition": {
        "StringEquals": {
          "</span><span class="k">${</span><span class="nv">OIDC_PROVIDER</span><span class="k">}</span><span class="sh">:sub": "system:serviceaccount:service-foundry:service-foundry-builder"
        }
      }
    }
  ]
}
</span><span class="no">
EOF


</span><span class="k">if</span> <span class="o">!</span> aws iam get-role <span class="nt">--role-name</span> service-foundry-builder-role &amp;&gt; /dev/null <span class="p">;</span> <span class="k">then
  </span>aws iam create-role <span class="se">\</span>
    <span class="nt">--role-name</span> service-foundry-builder-role <span class="se">\</span>
    <span class="nt">--assume-role-policy-document</span> file://trust-policy.json


  aws iam attach-role-policy <span class="se">\</span>
    <span class="nt">--role-name</span> service-foundry-builder-role <span class="se">\</span>
    <span class="nt">--policy-arn</span> arn:aws:iam::<span class="k">${</span><span class="nv">AWS_ACCOUNT_ID</span><span class="k">}</span>:policy/eks-update-kubeconfig-policy
<span class="k">else
  </span><span class="nb">echo</span> <span class="s2">"service-foundry-builder-role already exists. Skipping creation."</span>
<span class="k">fi</span></code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="installed-components">Installed Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the bootstrap process is complete, the following components are deployed to your Kubernetes cluster and configured for GitOps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Kubernetes manifest files</strong> in Git Repository</p>
</li>
<li>
<p><strong>ArgoCD</strong> for GitOps-based application management</p>
</li>
<li>
<p><strong>Sealed Secrets</strong> for secure secret management</p>
</li>
<li>
<p><strong>Keycloak</strong> for single sign-on (SSO) and identity management</p>
</li>
<li>
<p><strong>Traefik</strong> as the ingress controller</p>
</li>
<li>
<p><strong>Service Foundry App Frontend</strong></p>
</li>
<li>
<p><strong>Service Foundry App Backend</strong></p>
</li>
<li>
<p><strong>Oauth2 Proxy</strong> for authentication</p>
</li>
<li>
<p><strong>Full SSO Integration</strong> across the Console frontend and backend</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="kubernetes-manifest-files-in-git">Kubernetes manifest files in Git</h3>
<div class="paragraph">
<p>The bootstrap script commits all generated Kubernetes manifests to the Git repository defined in GIT_OPS_REPO_URL. These manifests are stored under the $ARGOCD_APP_PREFIX_apps folder.</p>
</div>
<div class="paragraph">
<p>Manifests include:
 * Argo CD Applications
 * Kustomize-ready base and overlay resources
 * Sealed Secrets (actual Secrets are not stored for security)
 * Helm values and release metadata</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/github-provisioning.png" alt="github provisioning">
</div>
<div class="title">Figure 3. GitHub Repository with Kubernetes manifest files</div>
</div>
</div>
<div class="sect2">
<h3 id="argocd">ArgoCD</h3>
<div class="paragraph">
<p>Argo CD is deployed in the argocd namespace. All services deployed by the bootstrap process are managed as <strong>Argo CD Applications</strong> and grouped under a dedicated Argo CD Project.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Repositories Tab</strong>: Lists connected Git repositories.</p>
</li>
<li>
<p><strong>Applications Tab</strong>: Shows deployment status of each application.</p>
</li>
<li>
<p><strong>Projects Tab</strong>: Organizes and scopes application access.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>GitOps becomes the single source of truth for cluster state.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/argocd-applications.png" alt="argocd applications">
</div>
<div class="title">Figure 4. ArgoCD UI - Argocd Applications</div>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/argocd-repositories.png" alt="argocd repositories">
</div>
<div class="title">Figure 5. ArgoCD UI - Argocd Repositories</div>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/argocd-projects.png" alt="argocd projects">
</div>
<div class="title">Figure 6. ArgoCD UI - Argocd Projects</div>
</div>
</div>
<div class="sect2">
<h3 id="sealed-secrets">Sealed Secrets</h3>
<div class="paragraph">
<p><strong>Sealed Secrets Controller</strong> is installed in the kube-system namespace. It ensures that secrets can be stored safely in Git repositories in encrypted form.</p>
</div>
<div class="paragraph">
<p>You can verify the controller is running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>kubectl get pods <span class="nt">-n</span> kube-system <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>sealed-secrets-controller
<span class="go">
</span><span class="gp">#</span><span class="w"> </span>Example output:
<span class="go">NAME                                             READY   STATUS    RESTARTS   AGE
pod/sealed-secrets-controller-6f44bdc558-pgj6p   1/1     Running   0          28m

NAME                                TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE
</span><span class="gp">service/sealed-secrets-controller   ClusterIP   10.100.94.127   &lt;none&gt;</span><span class="w">        </span>8080/TCP   4h26m
<span class="go">
NAME                                        READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/sealed-secrets-controller   1/1     1            1           4h26m

NAME                                                   DESIRED   CURRENT   READY   AGE
replicaset.apps/sealed-secrets-controller-6f44bdc558   1         1         1       4h26m</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A ClusterIP service is exposed for the controller, and only SealedSecrets (not raw Secrets) are stored in Git.</p>
</div>
</div>
<div class="sect2">
<h3 id="keycloak">Keycloak</h3>
<div class="paragraph">
<p>Keycloak is deployed in the keycloak namespace and exposed via a LoadBalancer service to support both internal and external authentication.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A realm named default is created.</p>
</li>
<li>
<p>An OAuth2 client named nsa2 is registered.</p>
</li>
<li>
<p>A default user devops with password password is created and assigned the admin role.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The OIDC issuer URL is available through the Keycloak service’s external IP.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl get svc keycloak <span class="nt">-n</span> keycloak

NAME       TYPE           CLUSTER-IP     EXTERNAL-IP                                                                 PORT<span class="o">(</span>S<span class="o">)</span>        AGE
keycloak   LoadBalancer   10.100.192.3   ac6dee47xxxxxxx-536941030.ca-central-1.elb.amazonaws.com   80:31243/TCP   4h33m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The OIDC ISSUER URL for Keycloak is: <code><a href="http://ac6dee47xxxxxxx-536941030.ca-central-1.elb.amazonaws.com/realms/default" class="bare">http://ac6dee47xxxxxxx-536941030.ca-central-1.elb.amazonaws.com/realms/default</a></code></p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/keycloak-clients.png" alt="keycloak clients">
</div>
<div class="title">Figure 7. Keycloak Clients</div>
</div>
</div>
<div class="sect2">
<h3 id="traefik">Traefik</h3>
<div class="paragraph">
<p>Traefik is deployed in the traefik namespace and serves as the ingress gateway for all Service Foundry Console components.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>kubectl get svc traefik <span class="nt">-n</span> traefik
<span class="go">
</span><span class="gp">#</span><span class="w"> </span>Example output:
<span class="go">NAME      TYPE           CLUSTER-IP       EXTERNAL-IP                                                                  PORT(S)                      AGE
traefik   LoadBalancer   10.100.221.209   a037cbea01f4yyyyyyyy-1420357204.ca-central-1.elb.amazonaws.com   80:30929/TCP,443:30565/TCP   4h38m
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Traefik uses IngressRoute resources to route traffic based on domain names (configured using SF_ROOT_DOMAIN).</p>
</div>
</div>
<div class="sect2">
<h3 id="service-foundry-console-frontend">Service Foundry Console (Frontend)</h3>
<div class="paragraph">
<p>The frontend UI is built with React.js and provides a visual interface for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploying applications</p>
</li>
<li>
<p>Managing GitOps pipelines</p>
</li>
<li>
<p>Viewing current resource state</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is deployed in the service-foundry namespace and routed via Traefik and OAuth2 Proxy.</p>
</div>
</div>
<div class="sect2">
<h3 id="service-foundry-console-backend">Service Foundry Console (Backend)</h3>
<div class="paragraph">
<p>The backend is a Go-based REST API that powers the frontend UI and manages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interactions with Kubernetes APIs</p>
</li>
<li>
<p>Git repository operations</p>
</li>
<li>
<p>Application state and deployment logic</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It runs in the service-foundry namespace and communicates securely with the frontend.</p>
</div>
</div>
<div class="sect2">
<h3 id="oauth2-proxy">Oauth2 Proxy</h3>
<div class="paragraph">
<p>OAuth2 Proxy is deployed to enforce authentication with Keycloak. It sits in front of the Console and handles login flows, token validation, and session management.</p>
</div>
<div class="paragraph">
<p>Verify its status with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>kubectl <span class="nt">-n</span> service-foundry get all <span class="nt">-l</span> app.kubernetes.io/name<span class="o">=</span>oauth2-proxy
<span class="go">
</span><span class="gp">#</span><span class="w"> </span>Example output:
<span class="go">NAME                               READY   STATUS    RESTARTS        AGE
pod/oauth2-proxy-6bbcfcd8f-rsrhd   1/1     Running   5 (8m16s ago)   10m

NAME                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)            AGE
</span><span class="gp">service/oauth2-proxy   ClusterIP   10.100.166.228   &lt;none&gt;</span><span class="w">        </span>80/TCP,44180/TCP   4h57m
<span class="go">
NAME                           READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/oauth2-proxy   1/1     1            1           4h57m

NAME                                     DESIRED   CURRENT   READY   AGE
replicaset.apps/oauth2-proxy-6bbcfcd8f   1         1         1       4h57m</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sso-integration">SSO Integration</h3>
<div class="paragraph">
<p>Both the frontend and backend are integrated with Keycloak through OAuth2 Proxy using a shared session and authorization mechanism.</p>
</div>
<div class="paragraph">
<p>IngressRoutes for both components include:
 * cors-headers middleware for cross-origin requests
 * forward-auth middleware to delegate authentication to Keycloak</p>
</div>
<div class="listingblock">
<div class="title">verify IngressRoute for Service Foundry Console Frontend</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl <span class="nt">-n</span> service-foundry get ingressroute service-foundry-sso-ingress-route <span class="nt">-o</span> yaml <span class="se">\</span>
| yq <span class="s1">'pick(["spec"])'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example IngressRoute for Service Foundry App Frontend</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">spec</span><span class="pi">:</span>
  <span class="na">entryPoints</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">web</span>
  <span class="na">routes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">kind</span><span class="pi">:</span> <span class="s">Rule</span>
      <span class="na">match</span><span class="pi">:</span> <span class="s">Host(`sfapp.nsa2.com`)</span>
      <span class="na">middlewares</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">cors-headers</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">forward-auth</span>
      <span class="na">services</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">service-foundry-app-frontend</span>
          <span class="na">port</span><span class="pi">:</span> <span class="s">http</span>
    <span class="pi">-</span> <span class="na">kind</span><span class="pi">:</span> <span class="s">Rule</span>
      <span class="na">match</span><span class="pi">:</span> <span class="s">Host(`sfapp-backend.nsa2.com`)</span>
      <span class="na">middlewares</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">cors-headers</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">forward-auth</span>
      <span class="na">services</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">service-foundry-app-backend</span>
          <span class="na">port</span><span class="pi">:</span> <span class="s">http</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For both frontend and backend, the IngressRoute is configured to use the <code>cors-headers</code> middleware for handling CORS headers and the <code>forward-auth</code> middleware for forwarding authentication requests to Keycloak.</p>
</div>
<div class="sect3">
<h4 id="middlewares-for-cors-and-forward-auth">Middlewares for CORS and Forward Auth</h4>
<div class="paragraph">
<p>There are two middlewares configured for the Service Foundry App Frontend and Backend:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cors-headers: This middleware adds CORS headers to the responses, allowing cross-origin requests from the frontend to the backend.</p>
</li>
<li>
<p>forward-auth: This middleware forwards authentication requests to Keycloak, enabling single sign-on (SSO) capabilities for the Service Foundry Console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example Middleware for CORS Headers</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">kubectl <span class="nt">-n</span> service-foundry get middleware cors-headers <span class="nt">-o</span> yaml | yq <span class="s1">'pick(["kind",  "spec"])'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">kind</span><span class="pi">:</span> <span class="s">Middleware</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">headers</span><span class="pi">:</span>
    <span class="na">accessControlAllowCredentials</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">accessControlAllowHeaders</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">Content-Type</span>
      <span class="pi">-</span> <span class="s">Authorization</span>
      <span class="pi">-</span> <span class="s">X-Requested-With</span>
      <span class="pi">-</span> <span class="s">Accept</span>
      <span class="pi">-</span> <span class="s">Origin</span>
    <span class="na">accessControlAllowMethods</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">GET</span>
      <span class="pi">-</span> <span class="s">OPTIONS</span>
      <span class="pi">-</span> <span class="s">PUT</span>
      <span class="pi">-</span> <span class="s">POST</span>
      <span class="pi">-</span> <span class="s">DELETE</span>
      <span class="pi">-</span> <span class="s">PATCH</span>
    <span class="na">accessControlAllowOriginList</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">http://sfapp.nsa2.com</span>
      <span class="pi">-</span> <span class="s">http://sfapp-backend.nsa2.com</span>
    <span class="na">accessControlMaxAge</span><span class="pi">:</span> <span class="m">100</span>
    <span class="na">addVaryHeader</span><span class="pi">:</span> <span class="kc">true</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Middleware for Forward Auth</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl <span class="nt">-n</span> service-foundry get middleware forward-auth <span class="nt">-o</span> yaml | yq <span class="s1">'pick(["kind", "spec"])'</span>

<span class="c"># Example output:</span>
kind: Middleware
spec:
  forwardAuth:
    address: http://oauth2-proxy.service-foundry.svc.cluster.local/oauth2/
    authResponseHeaders:
      - X-Auth-Request-User
      - X-Auth-Request-Email
      - Authorization
    trustForwardHeader: <span class="nb">true</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="accessing-service-foundry-console">Accessing Service Foundry Console</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the bootstrap process completes, you can access the Service Foundry Console via a browser. It offers a user-friendly interface for provisioning applications, managing Kubernetes resources, and tracking GitOps workflows visually.</p>
</div>
<div class="sect2">
<h3 id="dns-configuration">DNS Configuration</h3>
<div class="paragraph">
<p>To access the Service Foundry Console, you must configure DNS records that map domain names to the external IP of the Traefik LoadBalancer. These domain names are based on the value of SF_ROOT_DOMAIN.</p>
</div>
<div class="paragraph">
<p>For example, if SF_ROOT_DOMAIN is nsa2.com, your DNS entries should look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="toml"><span class="err">{traefik-lb-public-ip-address}</span>	  <span class="err">oauth2-proxy.nsa2.com</span>	   <span class="c"># Oauth2 Proxy</span>
<span class="err">{traefik-lb-public-ip-address}</span>	  <span class="err">sfapp.nsa2.com</span>           <span class="c"># Console Frontend</span>
<span class="err">{traefik-lb-public-ip-address}</span>	  <span class="err">sfapp-backend.nsa2.com</span>   <span class="c"># Console Backend</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Visit <a href="http://sfapp.nsa2.com" class="bare">http://sfapp.nsa2.com</a> to launch the frontend.</p>
</div>
</div>
<div class="sect2">
<h3 id="logging-in">Logging In</h3>
<div class="paragraph">
<p>When accessing the Console, your browser is redirected to Keycloak for authentication. Use the default login credentials:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Username: devops</p>
</li>
<li>
<p>Password: password</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These credentials were created during the bootstrap process and can be managed within Keycloak.</p>
</div>
<div class="imageblock img-wide img-wide">
<div class="content">
<img src="images/sfapp-login.png" alt="sfapp login">
</div>
<div class="title">Figure 8. Login Page provided by Keycloak</div>
</div>
</div>
<div class="sect2">
<h3 id="application-management-ui">Application Management UI</h3>
<div class="paragraph">
<p>Once logged in, you’ll land on the Installed Components view. From there, you can monitor existing deployments, check their sync status, or deploy additional components.</p>
</div>
<div class="paragraph">
<p>Click the “Deploy More Components” button to select new infrastructure modules (like Prometheus Operator) and generate configuration files using the Console UI.</p>
</div>
<div class="paragraph">
<p>These files are committed to the GitOps repository, and ArgoCD automatically applies the changes in the cluster.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/sfapp-installed-components.png" alt="sfapp installed components">
</div>
<div class="title">Figure 9. Installed Components</div>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/sfapp-deploy-dark.png" alt="sfapp deploy dark">
</div>
<div class="title">Figure 10. Deploy More Components in Dark Mode</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Argocd Application Prefix</strong>: infra-</p>
</li>
<li>
<p><strong>Prometheus Operator</strong>: check</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And the click 'Deploy' button to deploy the selected components.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/github-prometheus-operator.png" alt="github prometheus operator">
</div>
<div class="title">Figure 11. Git Repository with Prometheus Operator configuration files</div>
</div>
<div class="paragraph">
<p>After a while, you can also see the Prometheus Operator on ArgoCD UI.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/argocd-prometheus-operator.png" alt="argocd prometheus operator">
</div>
<div class="title">Figure 12. ArgoCD UI - Prometheus Operator Application</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="auto-sync-with-argocd">Auto Sync with ArgoCD</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ArgoCD is configured for auto-sync, meaning any changes committed to the GitOps repository are automatically reflected in the Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>Here is an example of how to update the Prometheus Operator configuration:</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/vscode-edit-custom-values.png" alt="vscode edit custom values">
</div>
<div class="title">Figure 13. VS Code Editor - Editing Configuration Files</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit custom-values.yaml to set replicaCount: 2</p>
</li>
<li>
<p>Run:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git commit -am "Increase replica count"
$ git push origin main</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>ArgoCD detects the update and syncs the application automatically.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can visually confirm the update via the ArgoCD UI or CLI.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/argocd-update-resources.png" alt="argocd update resources">
</div>
<div class="title">Figure 14. ArgoCD UI - Auto Sync</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="future-enhancements">Future Enhancements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Service Foundry Console will continue to evolve with features focused on user experience, security, and operational insight:</p>
</div>
<div class="sect2">
<h3 id="kubernetes-resource-management">Kubernetes Resource Management</h3>
<div class="paragraph">
<p>View and manage deployments, scale resources, and monitor pod health directly in the UI.</p>
</div>
</div>
<div class="sect2">
<h3 id="integrated-monitoring-and-observability">Integrated Monitoring and Observability</h3>
<div class="paragraph">
<p>Deeper integration with Prometheus, Grafana, and Tempo to visualize application performance, logs, and traces.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <strong>Service Foundry Console</strong>, combined with the <strong>Builder platform</strong>, offers a powerful yet approachable way to manage Kubernetes GitOps workflows. It abstracts complex configurations and provides a seamless interface for deploying, scaling, and observing modern cloud-native applications.</p>
</div>
<div class="paragraph">
<p>By combining ArgoCD, Keycloak, Traefik, and Sealed Secrets under a single configuration-driven platform, Service Foundry enables teams to shift their focus from infrastructure wiring to application delivery and operational excellence.</p>
</div>
<div class="paragraph">
<p>📘 View the web version:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://nsalexamy.github.io/service-foundry/pages/documents/blog/streamline-k8s-gitops/" class="bare">https://nsalexamy.github.io/service-foundry/pages/documents/blog/streamline-k8s-gitops/</a></p>
</li>
</ul>
</div>
</div>
</div>
        </div>
    </main>
</div>




<script>
    const toc = document.getElementById('toc');
    const container = document.getElementById('toc-container');
    if (toc && container) {
        container.appendChild(toc);
    }
</script>


<!--<button onclick="toggleTheme()" style="position: fixed; bottom: 1rem; right: 1rem; padding: 0.5rem 1rem; background-color: var(&#45;&#45;link); color: white; border: none; border-radius: 0.375rem; cursor: pointer;">-->
<!--    Toggle Theme-->
<!--</button>-->

<!--<script>-->
<!--    function toggleTheme() {-->
<!--        const html = document.documentElement;-->
<!--        const isDark = html.getAttribute("data-theme") === "dark";-->
<!--        html.setAttribute("data-theme", isDark ? "light" : "dark");-->
<!--        localStorage.setItem("theme", isDark ? "light" : "dark");-->
<!--    }-->

<!--    document.addEventListener("DOMContentLoaded", () => {-->
<!--        const savedTheme = localStorage.getItem("theme") || "light";-->
<!--        document.documentElement.setAttribute("data-theme", savedTheme);-->
<!--    });-->
<!--</script>-->

<!-- Footer -->
<footer class="bg-gray-900 text-white text-sm py-6 text-center">
    © 2025 Service Foundry. All rights reserved.
</footer>
</body>
</html>