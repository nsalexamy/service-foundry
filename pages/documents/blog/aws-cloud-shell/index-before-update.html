<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AWS Cloud Shell Setup Guide</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body {
            font-family: sans-serif;
            background-color: #f8fafc;
            color: #1f2937;
            margin: 0;
            padding: 0;
        }
    </style>
    
</head>
<body>
<div id="toc" class="toc">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#overview">Overview</a>
<ul class="sectlevel2">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#topics-covered">Topics Covered</a></li>
</ul>
</li>
<li><a href="#what-is-aws-cloud-shell">What is AWS Cloud Shell?</a>
<ul class="sectlevel2">
<li><a href="#features-of-aws-cloud-shell">Features of AWS Cloud Shell</a></li>
<li><a href="#shell-sessions">Shell sessions</a></li>
</ul>
</li>
<li><a href="#steps-to-set-up-aws-cloud-shell">Steps to Set Up AWS Cloud Shell</a>
<ul class="sectlevel2">
<li><a href="#1-open-aws-cloud-shell">1. Open AWS Cloud Shell</a></li>
<li><a href="#2-configure-aws-cli">2. Configure AWS CLI</a></li>
<li><a href="#3-verify-tools-installation">3. Verify tools installation</a></li>
<li><a href="#4-install-helm">4. Install Helm</a></li>
<li><a href="#5-update-kubernetes-configuration-for-eks-cluster">5. Update Kubernetes configuration for EKS cluster</a></li>
<li><a href="#6-set-up-git-credentials-optional">6. Set up Git credentials (optional)</a></li>
<li><a href="#7-youre-all-set">7. You&#8217;re all set!</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="imageblock img-wide">
<div class="content">
<img src="images/cloud-shell-architecture.png" alt="cloud shell architecture">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This article provides a step-by-step guide to setting up AWS Cloud Shell for deploying Service Foundry using Helm charts.</p>
</div>
<div class="paragraph">
<p>It can be helpful for users who want to manage their AWS resources and Kubernetes clusters directly from the browser without needing to install any software locally.</p>
</div>
<div class="sect2">
<h3 id="prerequisites">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>An AWS account with necessary permissions.</p>
</li>
<li>
<p>Basic knowledge of AWS Cloud Shell and Kubernetes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="topics-covered">Topics Covered</h3>
<div class="ulist">
<ul>
<li>
<p>AWS Cloud Shell overview</p>
</li>
<li>
<p>Steps to set up AWS Cloud Shell</p>
</li>
<li>
<p>Installing and configuring AWS CLI, kubectl, and Helm</p>
</li>
<li>
<p>Connecting to an EKS cluster</p>
</li>
<li>
<p>Setting up Git credentials (optional)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-aws-cloud-shell">What is AWS Cloud Shell?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AWS Cloud Shell is a browser-based shell that provides you with command-line access to your AWS resources. It comes pre-installed with essential tools like AWS CLI, kubectl,  and git, making it easier to manage your AWS services without needing to set up a local environment.</p>
</div>
<div class="paragraph">
<p>For AIM users, free tier usage includes 1 GB of persistent storage. And remember that you cannot run a single task for more than 1 hour.</p>
</div>
<div class="sect2">
<h3 id="features-of-aws-cloud-shell">Features of AWS Cloud Shell</h3>
<div class="ulist">
<ul>
<li>
<p>Pre-configured with AWS CLI and other essential tools.</p>
</li>
<li>
<p>Automatically authenticated with your AWS credentials.</p>
</li>
<li>
<p>Fully managed by AWS, so no setup is required.</p>
</li>
<li>
<p>1 GB of persistent storage</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="shell-sessions">Shell sessions</h3>
<div class="ulist">
<ul>
<li>
<p>Inactive sessions: After 20 minutes of inactivity, your AWS Cloud Shell session will automatically pause. You can resume it by clicking the "Resume Session" button.</p>
</li>
<li>
<p>Long-running sessions: A shell session that runs continuously for 12 hours will be automatically terminated even if the user is regularly interacting with it.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="steps-to-set-up-aws-cloud-shell">Steps to Set Up AWS Cloud Shell</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="1-open-aws-cloud-shell">1. Open AWS Cloud Shell</h3>
<div class="paragraph">
<p>To open AWS Cloud Shell, log in to your AWS Management Console. In the top-right corner, click on the Cloud Shell icon (a terminal icon) to launch the shell environment.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/aws-console.png" alt="aws console">
</div>
<div class="title">Figure 1. AWS Cloud Shell - Launch</div>
</div>
</div>
<div class="sect2">
<h3 id="2-configure-aws-cli">2. Configure AWS CLI</h3>
<div class="paragraph">
<p>When using AWS Cloud Shell, the AWS CLI is already installed and configured with your credentials. However, you can verify your configuration by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>aws configure list</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"> aws configure list
NAME       : VALUE                    : TYPE             : LOCATION
profile    : &lt;not <span class="nb">set</span><span class="o">&gt;</span>                : None             : None
access_key : <span class="k">****************</span>HXWO     : container-role   :
secret_key : <span class="k">****************</span>99Rl     : container-role   :
region     : ca-central-1             : <span class="nb">env</span>              : <span class="o">[</span><span class="s1">'AWS_REGION'</span>, <span class="s1">'AWS_DEFAULT_REGION'</span><span class="o">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="3-verify-tools-installation">3. Verify tools installation</h3>
<div class="paragraph">
<p>AWS Cloud Shell comes pre-installed with several essential tools. You can verify their installation by checking their versions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>aws <span class="nt">--version</span>
<span class="nv">$ </span>kubectl version <span class="nt">--client</span>
<span class="nv">$ </span>git <span class="nt">--version</span>

<span class="nv">$ </span>helm version
bash: helm: <span class="nb">command </span>not found</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="4-install-helm">4. Install Helm</h3>
<div class="paragraph">
<p>If Helm is not installed, you can install it by running the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash

<span class="nv">$ </span>helm version</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="5-update-kubernetes-configuration-for-eks-cluster">5. Update Kubernetes configuration for EKS cluster</h3>
<div class="paragraph">
<p>To update your Kubernetes configuration to connect to your EKS cluster, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># Set your EKS cluster name</span>
<span class="nv">$ EKS_CLUSTER_NAME</span><span class="o">=</span><span class="s2">"your-eks-cluster-name"</span>
<span class="nv">$ </span>aws eks update-kubeconfig <span class="nt">--region</span> <span class="nv">$AWS_REGION</span> <span class="nt">--name</span> <span class="nv">$EKS_CLUSTER_NAME</span>

<span class="c"># Verify the connection</span>
<span class="nv">$ </span>kubectl get nodes

<span class="c"># Permission denied error</span>
E1126 19:22:33.267316     882 memcache.go:265] <span class="s2">"Unhandled Error"</span> <span class="nv">err</span><span class="o">=</span><span class="s2">"couldn't get current server API group list: the server has asked for the client to provide credentials"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you encounter a permission denied error, ensure that your AWS IAM user has the necessary permissions to access the EKS cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>aws sts get-caller-identity

<span class="c"># Output</span>
<span class="o">{</span>
    <span class="s2">"UserId"</span>: <span class="s2">"AID---------"</span>,
    <span class="s2">"Account"</span>: <span class="s2">"44------"</span>,
    <span class="s2">"Arn"</span>: <span class="s2">"arn:aws:iam::44-----:user/your-iam-user"</span>
<span class="o">}</span>

<span class="nv">$ </span>aws sts get-caller-identity <span class="nt">--query</span> Arn <span class="nt">--output</span> text
arn:aws:iam::44------:user/your-iam-user</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify that the IAM user has the required EKS permissions.</p>
</div>
<div class="paragraph">
<p>This exact ARN must be allowed in the EKS aws-auth ConfigMap.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl <span class="nt">-n</span> kube-system get configmap aws-auth <span class="nt">-o</span> yaml</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">INFO</dt>
<dd>
<p>This can be done by an admin user of the EKS cluster outside of Cloud Shell.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl edit configmap aws-auth <span class="nt">-n</span> kube-system</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the following under <code>mapUsers:</code> section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">data</span><span class="pi">:</span>
  <span class="na">mapUsers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">userarn</span><span class="pi">:</span> <span class="s">arn:aws:iam::445567090745:user/emillian</span>
      <span class="na">username</span><span class="pi">:</span> <span class="s">cloudshell-emillian</span>
      <span class="na">groups</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">system:masters</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Save and exit the editor.</p>
</div>
<div class="paragraph">
<p>After updating the aws-auth ConfigMap, try running the <code>kubectl get nodes</code> command again to verify that you can access the EKS cluster.</p>
</div>
<div class="listingblock">
<div class="title">kubectl get nodes</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl get nodes

NAME                                             STATUS   ROLES    AGE     VERSION
ip-192-168-18-56.ca-central-1.compute.internal   Ready    &lt;none&gt;   3h14m   v1.33.5-eks-ecaa3a6</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">helm list all namespaces</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span> helm list <span class="nt">-A</span>
NAME                    NAMESPACE       REVISION        UPDATED                                 STATUS          CHART                           APP VERSION
aws-cluster-autoscaler  kube-system     1               2025-11-26 09:25:19.295873 <span class="nt">-0800</span> <span class="nt">-0800</span>  deployed        cluster-autoscaler-9.50.1       1.33.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="6-set-up-git-credentials-optional">6. Set up Git credentials (optional)</h3>
<div class="paragraph">
<p>If you plan to clone private repositories, you may need to set up Git credentials. You can do this by configuring SSH keys.</p>
</div>
<div class="listingblock">
<div class="title">Generate SSH keys</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096 <span class="nt">-C</span> <span class="s2">"emillian@servicefoundry.org"</span> <span class="nt">-f</span> ~/.ssh/id_rsa

<span class="nv">$ </span><span class="nb">ls</span> ~/.ssh/

id_rsa  id_rsa.pub</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Upload the public key to your Git hosting service (e.g., GitHub, GitLab).</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span><span class="nb">cat</span> ~/.ssh/id_rsa.pub</code></pre>
</div>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/github-add-deploy-key-1.png" alt="github add deploy key 1">
</div>
<div class="title">Figure 2. Add the deploy key to your GitHub repository</div>
</div>
<div class="paragraph">
<p>Add GitHub&#8217;s host key automatically to the list of known hosts</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>ssh-keyscan github.com <span class="o">&gt;&gt;</span> ~/.ssh/known_hosts

<span class="nv">$ </span><span class="nb">cat</span> ~/.ssh/known_hosts</code></pre>
</div>
</div>
<div class="paragraph">
<p>Clone a private repository using SSH</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>git clone git@github.com:nsalexamy/service-foundry-demo.git</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="7-youre-all-set">7. You&#8217;re all set!</h3>
<div class="paragraph">
<p>You have now set up AWS Cloud Shell with AWS CLI, kubectl, and Helm. You can use this environment to manage your AWS resources and Kubernetes clusters.</p>
</div>
<div class="paragraph">
<p>Additional Tools in AWS Cloud Shell:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>yq: A lightweight and portable command-line YAML processor.</p>
</li>
<li>
<p>jq: A lightweight and flexible command-line JSON processor.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have successfully set up AWS Cloud Shell for managing your AWS resources and Kubernetes clusters. You can now use this environment to deploy and manage Service Foundry using Helm charts.</p>
</div>
<div class="paragraph">
<p>Service Foundry provides bootstrap scripts that can be executed in AWS Cloud Shell to simplify the deployment process. For more information, refer to the Service Foundry documentation.</p>
</div>
</div>
</div>
</body>
</html>