<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Managing Secrets Securely in GitOps with Sealed Secrets</title>
    <!-- rouge source highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/service-foundry/pages/assets/css/main.css">

    <!-- Highlight.js script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</head>
<body class="">

<!-- Header -->
<header>
<!--    <div class="logo text-xl font-semibold">Service Foundry</div>-->
    <a href="/service-foundry/pages/index.html" class="text-2xl font-semibold hover:text-teal-400">
    Service Foundry
</a>
    <nav>
    
        
        <a href="/service-foundry/pages/getting-started/" class="">Getting Started</a>
    
        
        <a href="/service-foundry/pages/products/" class="">Products</a>
    
        
        <a href="/service-foundry/pages/documents/" class="active">Docs</a>
    
        
        <a href="/service-foundry/pages/github/" class="">GitHub</a>
    
        
        <a href="/service-foundry/pages/developers/" class="">Developers</a>
    
        
        <a href="/service-foundry/pages/demo/" class="">Demo</a>
    
</nav>
</header>


    <!-- Sub-navigation for Foundries -->
    <div class="subnav">

    
    <a href="/service-foundry/pages/documents/service-foundry/" class="active">Service Foundry</a>

    
    <a href="/service-foundry/pages/documents/blog/" class="">Blog</a>

    
    <a href="/service-foundry/pages/documents/infra-foundry/" class="">Infra</a>

    
    <a href="/service-foundry/pages/documents/sso-foundry/" class="">SSO</a>

    
    <a href="/service-foundry/pages/documents/o11y-foundry/" class="">Observability</a>

    
    <a href="/service-foundry/pages/documents/backend-foundry/" class="">Backend</a>

    
    <a href="/service-foundry/pages/documents/bigdata-foundry/" class="">Big Data</a>

<!--    <a href="/service-foundry/pages/documents/infra-foundry/index-backup.html" class="text-gray-300 hover:text-white">Infra</a>-->
<!--    <a href="/service-foundry/pages/documents/sso-foundry/index-backup.html" class="text-gray-300 hover:text-white">SSO</a>-->
<!--    <a href="/service-foundry/pages/documents/o11y-foundry/index-backup.html" class="text-gray-300 hover:text-white">Observability</a>-->
<!--    <a href="/service-foundry/pages/documents/backend-foundry/index-backup.html" class="text-gray-300 hover:text-white">Backend</a>-->
<!--    <a href="/service-foundry/pages/documents/bigdata-foundry/index-backup.html" class="text-gray-300 hover:text-white">Big Data</a>-->
</div>





<!-- Breadcrumb -->

    <nav class="breadcrumb-wrapper">
    <ol class="breadcrumb">
        
        <li>
            
            <a href="/service-foundry/pages/">Home</a>
            
            
            <span class="separator">/</span>
            
        </li>
        
        <li>
            
            <a href="/service-foundry/pages/documents/">Docs</a>
            
            
            <span class="separator">/</span>
            
        </li>
        
        <li>
            
            <a href="/service-foundry/pages/documents/service-foundry/">Service Foundry</a>
            
            
        </li>
        
    </ol>
</nav>





<!-- Main Layout -->
<div class="container">


    <nav id="toc-container" class="toc-nav"></nav>


    <main id="main-content">
        
        <div class="author-box">
            Young Gyu Kim
            &lt;<a href="mailto:credemol@gmail.com" style="color: #0d9488; text-decoration: none;">credemol@gmail.com</a>&gt;
        </div>
        

        <!-- Title -->
        
        <h1 class="page-title">
            Managing Secrets Securely in GitOps with Sealed Secrets
        </h1>
        

        <div class="asciidoc">
            <div id="toc" class="toc">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#user-case">User Case</a></li>
<li><a href="#secure-secrets-with-service-foundry-console">Secure Secrets with Service Foundry Console</a></li>
<li><a href="#sample-application-overview">Sample Application Overview</a></li>
<li><a href="#editing-sealed-secrets">Editing Sealed Secrets</a>
<ul class="sectlevel2">
<li><a href="#summary-editing-sealed-secrets">Summary: Editing Sealed Secrets</a></li>
</ul>
</li>
<li><a href="#how-sealed-secrets-work">How Sealed Secrets Work</a></li>
<li><a href="#what-happens-when-the-cluster-changes">What Happens When the Cluster Changes?</a>
<ul class="sectlevel2">
<li><a href="#cluster-upgrade-same-keys-retained">Cluster Upgrade (Same Keys Retained)</a></li>
<li><a href="#cluster-recreation-new-keys">Cluster Recreation (New Keys)</a></li>
<li><a href="#controller-reinstallation-new-keys">Controller Reinstallation (new keys)</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#backup-and-restore-keys">Backup and Restore Keys</a></li>
<li><a href="#bulk-re-sealing">Bulk Re-Sealing</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="imageblock img-wide">
<div class="content">
<img src="images/automated-gitops-secrets-management.png" alt="automated gitops secrets management">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide explores how to manage sensitive information securely in a GitOps workflow using Sealed Secrets, without exposing secrets in plain text. Leveraging the power of Service Foundry Console, we demonstrate a seamless and automated approach to encrypting, editing, and storing Kubernetes secrets in Git repositories.</p>
</div>
<div class="paragraph">
<p>Using a sample Spring Boot application connected to a PostgreSQL database, we’ll walk through how Service Foundry Console simplifies secrets management with full GitOps integration, eliminating the need for direct command-line operations. For foundational knowledge of Sealed Secrets, refer to my previous article.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://nsalexamy.github.io/service-foundry/pages/documents/infra-foundry/gitops-sealed-secrets/">Securing Sensitive Data in GitOps with Sealed Secrets</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-case">User Case</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Imagine deploying a Spring Boot application that connects to a PostgreSQL database. The application requires credentials—sensitive information that must be managed securely. Rather than committing plain-text secrets to a Git repository, you can use <strong>Sealed Secrets</strong> to safely encrypt and store them within your GitOps workflow.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="secure-secrets-with-service-foundry-console">Secure Secrets with Service Foundry Console</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Service Foundry Console handles secret encryption automatically. The Sealed Secrets controller in the Kubernetes cluster will then decrypt these secrets and create standard Kubernetes Secrets that the application can use.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/securing-sensitive-data.png" alt="securing sensitive data">
</div>
<div class="title">Figure 1. Securing Sensitive Data with Sealed Secrets</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sample-application-overview">Sample Application Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This example uses a Spring Boot container image deployed in Kubernetes with the following manifest files:</p>
</div>
<div class="paragraph">
<p><strong>Container image</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>'docker.io/credemol/postgresql-example:0.1.0'</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Manifest file</strong>s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>kustomization.yaml</p>
</li>
<li>
<p>postgresql-example-deployment.yaml</p>
</li>
<li>
<p>postgresql-example-service.yaml</p>
</li>
<li>
<p>postgresql-example-configmap.yaml</p>
</li>
<li>
<p>postgresql-example-secret.yaml (to be replaced with Sealed Secret)</p>
</li>
<li>
<p>postgresql-example-ingress.yaml</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When installing the application, the user will need to provide the following sensitive information in the 'postgresql-example-secret.yaml' file:</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/console-enterprise-app-install.png" alt="console enterprise app install">
</div>
<div class="title">Figure 2. Console - Add Secret to Kustomization</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="editing-sealed-secrets">Editing Sealed Secrets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because Sealed Secrets are encrypted, they cannot be edited directly. Traditionally, this involves unsealing, editing, and resealing the secret using the CLI. With Service Foundry Console, this process is automated behind a simple UI:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the pencil icon to edit.</p>
</li>
<li>
<p>Unlock to view the unsealed data.</p>
</li>
<li>
<p>Make changes and save.</p>
</li>
<li>
<p>Publish to push changes to Git—automatically resealed by the backend.</p>
</li>
</ol>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/console-edit-sealed-secret.png" alt="console edit sealed secret">
</div>
<div class="title">Figure 3. Console - Edit Sealed Secret</div>
</div>
<div class="paragraph">
<p>After clicking the unlock icon, you can view and edit the unsealed Secret data.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/console-edit-unsealed-secret.png" alt="console edit unsealed secret">
</div>
<div class="title">Figure 4. Console - Unsealed Secret Data</div>
</div>
<div class="paragraph">
<p>POSTGRES_PASSWORD is added to the Secret data.</p>
</div>
<div class="imageblock img-medium">
<div class="content">
<img src="images/console-commit-message.png" alt="console commit message">
</div>
<div class="title">Figure 5. Console - Commit Changes to Git</div>
</div>
<div class="paragraph">
<p>On GitHub, you can see the updated Sealed Secret with the new encrypted data.</p>
</div>
<div class="imageblock img-wide">
<div class="content">
<img src="images/github-sealed-secret-updated.png" alt="github sealed secret updated">
</div>
<div class="title">Figure 6. GitHub - Updated Sealed Secret</div>
</div>
<div class="sect2">
<h3 id="summary-editing-sealed-secrets">Summary: Editing Sealed Secrets</h3>
<div class="paragraph">
<p>Service Foundry Console simplifies editing Sealed Secrets by abstracting the complexity of encryption. You can securely update sensitive data without manually running kubeseal or editing YAML files outside the GitOps workflow.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-sealed-secrets-work">How Sealed Secrets Work</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Sealed Secrets are created by encrypting Kubernetes Secret data using a public key.</p>
</li>
<li>
<p>The sealed resource is stored in Git.</p>
</li>
<li>
<p>The Kubernetes controller decrypts it with the private key at runtime and creates a Secret.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-happens-when-the-cluster-changes">What Happens When the Cluster Changes?</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cluster-upgrade-same-keys-retained">Cluster Upgrade (Same Keys Retained)</h3>
<div class="ulist">
<ul>
<li>
<p>Minor/major Kubernetes upgrades (e.g., EKS v1.31 → v1.32) keep the etcd store and keys intact.</p>
</li>
<li>
<p>Sealed Secrets remain valid.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cluster-recreation-new-keys">Cluster Recreation (New Keys)</h3>
<div class="ulist">
<ul>
<li>
<p>If the cluster is recreated, the private key is lost unless backed up.</p>
</li>
<li>
<p>All Sealed Secrets must be re-created.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="controller-reinstallation-new-keys">Controller Reinstallation (new keys)</h3>
<div class="ulist">
<ul>
<li>
<p>A fresh controller installation generates new keys.</p>
</li>
<li>
<p>Existing Sealed Secrets can no longer be decrypted.</p>
</li>
<li>
<p>Backup and restore are essential in this scenario.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="best-practices">Best Practices</h3>
<div class="ulist">
<ul>
<li>
<p>Back up the Sealed Secrets private key as you would for etcd.</p>
</li>
<li>
<p>For multi-cluster environments, consider using shared keys.</p>
</li>
<li>
<p>Rotate keys with caution and reseal all secrets.</p>
</li>
<li>
<p>Limit access to the private key and audit regularly.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="backup-and-restore-keys">Backup and Restore Keys</h3>
<div class="listingblock">
<div class="title">[source,shell]</div>
<div class="content">
<pre>$ kubectl get secret -n kube-system sealed-secrets-key -o yaml &gt; sealed-secrets-key-backup.yaml</pre>
</div>
</div>
<div class="listingblock source">
<div class="title">Restore Sealed Secrets Key</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>kubectl apply <span class="nt">-f</span> sealed-secrets-key-backup.yaml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bulk-re-sealing">Bulk Re-Sealing</h3>
<div class="paragraph">
<p>If rotating keys or migrating clusters, you can bulk reseal secrets using kubeseal.</p>
</div>
<div class="listingblock source">
<div class="title">Bulk Re-Seal Secrets</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="nv">PUB_CERT</span><span class="o">=</span>pub-cert.pem
<span class="nv">NAMESPACE</span><span class="o">=</span>my-namespace

<span class="c"># List all Secrets you want to reseal</span>
<span class="nv">SECRETS</span><span class="o">=</span><span class="si">$(</span>kubectl get secrets <span class="nt">-n</span> <span class="nv">$NAMESPACE</span> <span class="nt">-o</span> name | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'default-token'</span><span class="si">)</span>

<span class="k">for </span>secret <span class="k">in</span> <span class="nv">$SECRETS</span><span class="p">;</span> <span class="k">do
  </span><span class="nv">name</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$secret</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'/'</span> <span class="nt">-f2</span><span class="si">)</span>
  <span class="nb">echo</span> <span class="s2">"🔄 Resealing </span><span class="nv">$name</span><span class="s2"> ..."</span>

  kubectl get <span class="nv">$secret</span> <span class="nt">-n</span> <span class="nv">$NAMESPACE</span> <span class="nt">-o</span> yaml <span class="se">\</span>
    | kubeseal <span class="nt">--cert</span> <span class="nv">$PUB_CERT</span> <span class="nt">--format</span> yaml <span class="o">&gt;</span> ./resealed/<span class="k">${</span><span class="nv">name</span><span class="k">}</span><span class="nt">-sealed</span>.yaml
<span class="k">done

</span><span class="nb">echo</span> <span class="s2">"✅ All Secrets resealed and saved in ./resealed"</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we demonstrated how to automate and manage GitOps secrets securely using Sealed Secrets. With the help of Service Foundry Console, you can edit, seal, and commit secrets without touching the command line. By following best practices and ensuring key backups, you can keep your secrets safe and portable across clusters and environments.</p>
</div>
<div class="paragraph">
<p>📘 View the web version:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://nsalexamy.github.io/service-foundry/pages/documents/service-foundry/gitops-secrets-management/" class="bare">https://nsalexamy.github.io/service-foundry/pages/documents/service-foundry/gitops-secrets-management/</a></p>
</li>
</ul>
</div>
</div>
</div>
        </div>
    </main>
</div>




<script>
    const toc = document.getElementById('toc');
    const container = document.getElementById('toc-container');
    if (toc && container) {
        container.appendChild(toc);
    }
</script>


<!--<button onclick="toggleTheme()" style="position: fixed; bottom: 1rem; right: 1rem; padding: 0.5rem 1rem; background-color: var(&#45;&#45;link); color: white; border: none; border-radius: 0.375rem; cursor: pointer;">-->
<!--    Toggle Theme-->
<!--</button>-->

<!--<script>-->
<!--    function toggleTheme() {-->
<!--        const html = document.documentElement;-->
<!--        const isDark = html.getAttribute("data-theme") === "dark";-->
<!--        html.setAttribute("data-theme", isDark ? "light" : "dark");-->
<!--        localStorage.setItem("theme", isDark ? "light" : "dark");-->
<!--    }-->

<!--    document.addEventListener("DOMContentLoaded", () => {-->
<!--        const savedTheme = localStorage.getItem("theme") || "light";-->
<!--        document.documentElement.setAttribute("data-theme", savedTheme);-->
<!--    });-->
<!--</script>-->

<!-- Footer -->
<footer class="bg-gray-900 text-white text-sm py-6 text-center">
    © 2025 Service Foundry. All rights reserved.
</footer>
</body>
</html>